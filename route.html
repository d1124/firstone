
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>测试 - layui</title>
  <link rel="stylesheet" href="layui/css/layui.css">

    <script src="jquery-1.12.4.js"></script>
<script src="Bmob-2.2.5.min.js"></script>
</head>
<body>

  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 50px;">
    <legend>批量处理事件</legend>
  </fieldset>
  <div class="layui-btn-container">
    <button class="layui-btn" lay-active="e1">事件1</button>
    <button class="layui-btn" lay-active="e2">事件2</button>
    <button class="layui-btn" lay-active="e3">事件3</button>
  </div>

  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
    <legend>选择</legend>
  </fieldset>
  <div class="layui-btn-container">
    <button type="button" class="layui-btn" lay-demotransferactive="getData">发布早班</button>
    <button type="button" class="layui-btn" lay-demotransferactive="reload">自动选择</button>
  </div>
  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
  <legend>早班</legend>
</fieldset>
<div id="test7" class="demo-transfer"></div>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
  <legend>中班</legend>
</fieldset>
<div id="test8" class="demo-transfer"></div>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
  <legend>晚班</legend>
</fieldset>
<div id="test9" class="demo-transfer"></div>

<!-- 引入 layui.js 的 <script> 标签最好放置在 html 末尾 -->
<script src="layui/layui.js"></script>

<script>
layui.use(['transfer', 'layer', 'util'], function(){
  var $ = layui.$
  ,transfer = layui.transfer
  ,layer = layui.layer
  ,util = layui.util;

// Bmob.initialize("2ba7d49d6cd824c5", "981124");
Bmob.initialize("f1cdf3c708bde14d", "981124");
var data1 = [
{"value": "1001", "title": "李白","time":"1"}
,{"value": "2001", "title": "李白","time":"2"}
,{"value": "3001", "title": "李白","time":"3"}
,{"value": "2", "title": "杜甫"}
,{"value": "3", "title": "苏轼"}
,{"value": "4", "title": "李清照"}
,{"value": "5", "title": "鲁迅", "disabled": true}
,{"value": "6", "title": "巴金"}
,{"value": "7", "title": "冰心"}
,{"value": "8", "title": "矛盾"}
,{"value": "9", "title": "贤心"}
]

//实例调用
transfer.render({
  elem: '#test7'
  ,showSearch: true
  ,data: data1
  ,parseData: function(res){
  return {
    "value": res.value //数据值
    ,"title": res.title+"("+res.time+")" //数据标题
    ,"disabled": res.disabled  //是否禁用
    ,"checked": res.checked //是否选中
  }
}
  ,title: ['全部地点', '早班选中地点']
  ,id: 'key1' //定义唯一索引
  ,value: ["1", "3", "5"]
})

transfer.render({
  elem: '#test8'
  ,showSearch: true
  ,data: data1
  ,title: ['全部地点', '中班选中地点']
  ,id: 'key2' //定义唯一索引
  ,value: ["2", "4", "6"]
})


transfer.render({
  elem: '#test9'
  ,showSearch: true
  ,data: data1
  ,title: ['全部地点', '晚班选中地点']
  ,id: 'key3' //定义唯一索引
  ,value: ["7", "8", "9"]
})



// 批量办法定事件
util.event('lay-demoTransferActive', {
  getData: function(othis){

    var getData = transfer.getData('key1'); //获取右侧数据
    layer.alert(JSON.stringify(getData));


  }
  ,reload:function(){
    //实例重载
    transfer.reload('key1', {
      value: ['2', '5', '3']
      ,showSearch: true
      ,parseData: function(res){
      return {
        "value": res.value //数据值
        ,"title": res.title //数据标题
        ,"disabled": res.disabled  //是否禁用
        ,"checked": res.checked //是否选中
      }
    }
    })
    transfer.reload('key2', {
      value: ['1', '2', '11']
      ,showSearch: true
    })
    transfer.reload('key3', {
      value: ['12', '6', '7']
      ,showSearch: true
    })
  }
});


//处理属性 为 lay-active 的所有元素事件
util.event('lay-active', {
  e1: function(){
    layer.msg('初始化地区');
    const queryArray = new Array();
for(var i = 0 ; i < 3 ; i++){
  var queryObj = Bmob.Query('Data');
  queryObj.set('place','abc' + i);
  queryObj.set('Date','2021-05-18');
  queryObj.set('classname','早');
  queryArray.push(queryObj);
}


// 传入刚刚构造的数组
Bmob.Query('Data').saveAll(queryArray).then(result => {
  console.log(result);
}).catch(err => {
  console.log(err);
});



  }
  ,e2: function(){
    layer.msg('触发了事件2');
  }
  ,e3: function(){
    layer.msg('触发了事件3');
  }
});


});
</script>
</body>
</html>
